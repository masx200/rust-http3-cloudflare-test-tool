<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `hickory-dns-main\crates\client\src\lib.rs`."><title>lib.rs - source</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="hickory_client" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="../../static.files/src-script-813739b1.js"></script><script defer src="../../src-files.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc src"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="src-sidebar-title"><h2>Files</h2></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><section id="main-content" class="content"><div class="main-heading"><h1><div class="sub-heading">hickory_client/</div>lib.rs</h1><rustdoc-toolbar></rustdoc-toolbar></div><div class="example-wrap digits-3"><pre class="rust"><code><a href=#1 id=1 data-nosnippet>1</a><span class="comment">/*
<a href=#2 id=2 data-nosnippet>2</a> * Copyright (C) 2015 Benjamin Fry &lt;benjaminfry@me.com&gt;
<a href=#3 id=3 data-nosnippet>3</a> *
<a href=#4 id=4 data-nosnippet>4</a> * Licensed under the Apache License, Version 2.0 (the "License");
<a href=#5 id=5 data-nosnippet>5</a> * you may not use this file except in compliance with the License.
<a href=#6 id=6 data-nosnippet>6</a> * You may obtain a copy of the License at
<a href=#7 id=7 data-nosnippet>7</a> *
<a href=#8 id=8 data-nosnippet>8</a> *     https://www.apache.org/licenses/LICENSE-2.0
<a href=#9 id=9 data-nosnippet>9</a> *
<a href=#10 id=10 data-nosnippet>10</a> * Unless required by applicable law or agreed to in writing, software
<a href=#11 id=11 data-nosnippet>11</a> * distributed under the License is distributed on an "AS IS" BASIS,
<a href=#12 id=12 data-nosnippet>12</a> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
<a href=#13 id=13 data-nosnippet>13</a> * See the License for the specific language governing permissions and
<a href=#14 id=14 data-nosnippet>14</a> * limitations under the License.
<a href=#15 id=15 data-nosnippet>15</a> */
<a href=#16 id=16 data-nosnippet>16</a>
<a href=#17 id=17 data-nosnippet>17</a>// LIBRARY WARNINGS
<a href=#18 id=18 data-nosnippet>18</a></span><span class="attr">#![warn(
<a href=#19 id=19 data-nosnippet>19</a>    clippy::default_trait_access,
<a href=#20 id=20 data-nosnippet>20</a>    clippy::dbg_macro,
<a href=#21 id=21 data-nosnippet>21</a>    clippy::print_stdout,
<a href=#22 id=22 data-nosnippet>22</a>    clippy::unimplemented,
<a href=#23 id=23 data-nosnippet>23</a>    clippy::use_self,
<a href=#24 id=24 data-nosnippet>24</a>    missing_copy_implementations,
<a href=#25 id=25 data-nosnippet>25</a>    missing_docs,
<a href=#26 id=26 data-nosnippet>26</a>    non_snake_case,
<a href=#27 id=27 data-nosnippet>27</a>    non_upper_case_globals,
<a href=#28 id=28 data-nosnippet>28</a>    rust_2018_idioms,
<a href=#29 id=29 data-nosnippet>29</a>    unreachable_pub
<a href=#30 id=30 data-nosnippet>30</a>)]
<a href=#31 id=31 data-nosnippet>31</a>#![allow(
<a href=#32 id=32 data-nosnippet>32</a>    clippy::needless_doctest_main,
<a href=#33 id=33 data-nosnippet>33</a>    clippy::single_component_path_imports,
<a href=#34 id=34 data-nosnippet>34</a>    clippy::upper_case_acronyms, <span class="comment">// can be removed on a major release boundary
<a href=#35 id=35 data-nosnippet>35</a>    </span>clippy::bool_to_int_with_if,
<a href=#36 id=36 data-nosnippet>36</a>)]
<a href=#37 id=37 data-nosnippet>37</a>#![recursion_limit = <span class="string">"1024"</span>]
<a href=#38 id=38 data-nosnippet>38</a>#![cfg_attr(docsrs, feature(doc_cfg, doc_auto_cfg))]
<a href=#39 id=39 data-nosnippet>39</a>
<a href=#40 id=40 data-nosnippet>40</a></span><span class="doccomment">//! Hickory DNS is intended to be a fully compliant domain name server and client library.
<a href=#41 id=41 data-nosnippet>41</a>//!
<a href=#42 id=42 data-nosnippet>42</a>//! The Client library is responsible for the basic protocols responsible for communicating with DNS servers (authorities) and resolvers. It can be used for managing DNS records through the use of update operations. It is possible to send raw DNS Messages with the Client, but for ease of use the `query` and various other update operations are recommended for general use.
<a href=#43 id=43 data-nosnippet>43</a>//!
<a href=#44 id=44 data-nosnippet>44</a>//! For a system-like resolver, see [hickory-resolver](https://docs.rs/hickory-resolver). This is most likely what you want if all you want to do is lookup IP addresses.
<a href=#45 id=45 data-nosnippet>45</a>//!
<a href=#46 id=46 data-nosnippet>46</a>//! For serving DNS serving, see [hickory-server](https://docs.rs/hickory-server).
<a href=#47 id=47 data-nosnippet>47</a>//!
<a href=#48 id=48 data-nosnippet>48</a>//! # Goals
<a href=#49 id=49 data-nosnippet>49</a>//!
<a href=#50 id=50 data-nosnippet>50</a>//! * Only safe Rust
<a href=#51 id=51 data-nosnippet>51</a>//! * All errors handled
<a href=#52 id=52 data-nosnippet>52</a>//! * Simple to manage servers
<a href=#53 id=53 data-nosnippet>53</a>//! * High level abstraction for clients
<a href=#54 id=54 data-nosnippet>54</a>//! * Secure dynamic update
<a href=#55 id=55 data-nosnippet>55</a>//! * New features for securing public information
<a href=#56 id=56 data-nosnippet>56</a>//!
<a href=#57 id=57 data-nosnippet>57</a>//! # Usage
<a href=#58 id=58 data-nosnippet>58</a>//!
<a href=#59 id=59 data-nosnippet>59</a>//! This shows basic usage of the Client. More examples will be associated directly with other types.
<a href=#60 id=60 data-nosnippet>60</a>//!
<a href=#61 id=61 data-nosnippet>61</a>//! ## Dependency
<a href=#62 id=62 data-nosnippet>62</a>//!
<a href=#63 id=63 data-nosnippet>63</a>//! ```toml
<a href=#64 id=64 data-nosnippet>64</a>//! [dependencies]
<a href=#65 id=65 data-nosnippet>65</a>//! hickory-client = "*"
<a href=#66 id=66 data-nosnippet>66</a>//! ```
<a href=#67 id=67 data-nosnippet>67</a>//!
<a href=#68 id=68 data-nosnippet>68</a>//! By default DNSSEC validation is built in with OpenSSL, this can be disabled with:
<a href=#69 id=69 data-nosnippet>69</a>//!
<a href=#70 id=70 data-nosnippet>70</a>//! ```toml
<a href=#71 id=71 data-nosnippet>71</a>//! [dependencies]
<a href=#72 id=72 data-nosnippet>72</a>//! hickory-client = { version = "*", default-features = false }
<a href=#73 id=73 data-nosnippet>73</a>//! ```
<a href=#74 id=74 data-nosnippet>74</a>//!
<a href=#75 id=75 data-nosnippet>75</a>//! ## Objects
<a href=#76 id=76 data-nosnippet>76</a>//!
<a href=#77 id=77 data-nosnippet>77</a>//! There are two variations of implementations of the client: the [`client::Client`], an
<a href=#78 id=78 data-nosnippet>78</a>//! async client usually used with the Tokio runtime and the [`client::DnssecClient`], which
<a href=#79 id=79 data-nosnippet>79</a>//! validates DNSSEC records. For these basic examples we'll only look at the `Client`.
<a href=#80 id=80 data-nosnippet>80</a>//!
<a href=#81 id=81 data-nosnippet>81</a>//! First we must decide on the type of connection. For the purpose of this example, we'll
<a href=#82 id=82 data-nosnippet>82</a>//! show how to set up a TCP-based connection.
<a href=#83 id=83 data-nosnippet>83</a>//!
<a href=#84 id=84 data-nosnippet>84</a>//! This example is meant to show basic usage, using the `#[tokio::main]` macro to setup a simple
<a href=#85 id=85 data-nosnippet>85</a>//! runtime. The Tokio documentation should be reviewed for more advanced usage.
<a href=#86 id=86 data-nosnippet>86</a>//!
<a href=#87 id=87 data-nosnippet>87</a>//! ```rust
<a href=#88 id=88 data-nosnippet>88</a>//! use std::net::Ipv4Addr;
<a href=#89 id=89 data-nosnippet>89</a>//! use std::str::FromStr;
<a href=#90 id=90 data-nosnippet>90</a>//! use tokio::net::TcpStream as TokioTcpStream;
<a href=#91 id=91 data-nosnippet>91</a>//! use hickory_client::client::{Client, ClientHandle};
<a href=#92 id=92 data-nosnippet>92</a>//! use hickory_client::proto::runtime::TokioRuntimeProvider;
<a href=#93 id=93 data-nosnippet>93</a>//! use hickory_client::proto::rr::{DNSClass, Name, RData, RecordType};
<a href=#94 id=94 data-nosnippet>94</a>//! use hickory_client::proto::rr::rdata::A;
<a href=#95 id=95 data-nosnippet>95</a>//! use hickory_client::proto::tcp::TcpClientStream;
<a href=#96 id=96 data-nosnippet>96</a>//!
<a href=#97 id=97 data-nosnippet>97</a>//! #[tokio::main]
<a href=#98 id=98 data-nosnippet>98</a>//! async fn main() {
<a href=#99 id=99 data-nosnippet>99</a>//!     // Since we used UDP in the previous examples, let's change things up a bit and use TCP here
<a href=#100 id=100 data-nosnippet>100</a>//!     let (stream, sender) =
<a href=#101 id=101 data-nosnippet>101</a>//!         TcpClientStream::new(([8, 8, 8, 8], 53).into(), None, None, TokioRuntimeProvider::new());
<a href=#102 id=102 data-nosnippet>102</a>//!
<a href=#103 id=103 data-nosnippet>103</a>//!     // Create a new client, the bg is a background future which handles
<a href=#104 id=104 data-nosnippet>104</a>//!     //   the multiplexing of the DNS requests to the server.
<a href=#105 id=105 data-nosnippet>105</a>//!     //   the client is a handle to an unbounded queue for sending requests via the
<a href=#106 id=106 data-nosnippet>106</a>//!     //   background. The background must be scheduled to run before the client can
<a href=#107 id=107 data-nosnippet>107</a>//!     //   send any dns requests
<a href=#108 id=108 data-nosnippet>108</a>//!     let client = Client::&lt;TokioRuntimeProvider&gt;::new(stream, sender, None);
<a href=#109 id=109 data-nosnippet>109</a>//!
<a href=#110 id=110 data-nosnippet>110</a>//!     // await the connection to be established
<a href=#111 id=111 data-nosnippet>111</a>//!     let (mut client, bg) = client.await.expect("connection failed");
<a href=#112 id=112 data-nosnippet>112</a>//!
<a href=#113 id=113 data-nosnippet>113</a>//!     // make sure to run the background task
<a href=#114 id=114 data-nosnippet>114</a>//!     tokio::spawn(bg);
<a href=#115 id=115 data-nosnippet>115</a>//!
<a href=#116 id=116 data-nosnippet>116</a>//!     // Create a query future
<a href=#117 id=117 data-nosnippet>117</a>//!     let query = client.query(
<a href=#118 id=118 data-nosnippet>118</a>//!         Name::from_str("www.example.com.").unwrap(),
<a href=#119 id=119 data-nosnippet>119</a>//!         DNSClass::IN,
<a href=#120 id=120 data-nosnippet>120</a>//!         RecordType::A,
<a href=#121 id=121 data-nosnippet>121</a>//!    );
<a href=#122 id=122 data-nosnippet>122</a>//!
<a href=#123 id=123 data-nosnippet>123</a>//!     // wait for its response
<a href=#124 id=124 data-nosnippet>124</a>//!     let response = query.await.unwrap();
<a href=#125 id=125 data-nosnippet>125</a>//!
<a href=#126 id=126 data-nosnippet>126</a>//!     // validate it's what we expected
<a href=#127 id=127 data-nosnippet>127</a>//!     if let RData::A(addr) = response.answers()[0].data() {
<a href=#128 id=128 data-nosnippet>128</a>//!         assert_eq!(*addr, A::new(93, 184, 215, 14));
<a href=#129 id=129 data-nosnippet>129</a>//!     }
<a href=#130 id=130 data-nosnippet>130</a>//! }
<a href=#131 id=131 data-nosnippet>131</a>//! ```
<a href=#132 id=132 data-nosnippet>132</a>//!
<a href=#133 id=133 data-nosnippet>133</a>//! In the above example we successfully queried for a A record. There are many other types, each
<a href=#134 id=134 data-nosnippet>134</a>//! can be independently queried and the associated [`crate::proto::rr::record_data::RData`]
<a href=#135 id=135 data-nosnippet>135</a>//! has a variant with the deserialized data for the record stored.
<a href=#136 id=136 data-nosnippet>136</a>//!
<a href=#137 id=137 data-nosnippet>137</a>//! ## Dynamic update
<a href=#138 id=138 data-nosnippet>138</a>//!
<a href=#139 id=139 data-nosnippet>139</a>//! Currently `hickory-client` supports SIG(0) signed records for authentication and authorization
<a href=#140 id=140 data-nosnippet>140</a>//! of dynamic DNS updates. Consult the [`client::DnssecClient`] API for more information.
<a href=#141 id=141 data-nosnippet>141</a>
<a href=#142 id=142 data-nosnippet>142</a></span><span class="kw">pub mod </span>client;
<a href=#143 id=143 data-nosnippet>143</a><span class="attr">#[cfg(test)]
<a href=#144 id=144 data-nosnippet>144</a></span><span class="kw">mod </span>tests;
<a href=#145 id=145 data-nosnippet>145</a>
<a href=#146 id=146 data-nosnippet>146</a><span class="kw">pub use </span>hickory_proto <span class="kw">as </span>proto;
<a href=#147 id=147 data-nosnippet>147</a>
<a href=#148 id=148 data-nosnippet>148</a><span class="doccomment">/// Returns a version as specified in Cargo.toml
<a href=#149 id=149 data-nosnippet>149</a></span><span class="kw">pub fn </span>version() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">'static </span>str {
<a href=#150 id=150 data-nosnippet>150</a>    <span class="macro">env!</span>(<span class="string">"CARGO_PKG_VERSION"</span>)
<a href=#151 id=151 data-nosnippet>151</a>}</code></pre></div></section></main></body></html>